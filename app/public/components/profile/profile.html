<div class="profile-background">
    <img style="margin-top:100px; object-fit: cover;" ng-src="{{user.backgroundPhoto}}">
</div>
<div class="col-md-12">
    <div class="col-sm-3">
        <div class="sizing-top">
            <div class="recently-viewed-box" style="margin-top: 80px;">
                <div class="card card-primary">
                    <div class="card-block">
                        <div class="card-title">
                            Last 10 Recently Viewed Courses
                        </div>
                        <ul ng-repeat="viewed in user.recentlyViewed | limitTo:10 | orderBy:'-'">
                            <li style="text-align:center;cursor:pointer;"><h4 ng-click="goToCourse(viewed._id)">{{viewed.title}}</h4></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="col-sm-8">
            <div class="sizing-top">
                <div class="profile-box-first">
                    <div class="profile-box-">
                        <div class="profile-edit" ng-click="changeBackground()">
                            Edit
                        </div>
                        <div class="sizing">
                            <div class="row">
                                <div class="outside-box-profile circle">
                                    <img class="profile-photo" ng-src="{{user.profiler}}">
                                </div>
                            </div>
                        </div>
                    </div>
                    <ul class="text-center list-unstyled">
                        <li><h3><b>{{user.firstName}} {{user.lastName}}</b></h3></li>
                        <li><h4>{{user.email}}</h4></li>
                    </ul>
                    <div class="col-sm-4 line-right text-center">
                        <h3>Average Test Score {{myAverage}}</h3>
                    </div>
                    <div class="col-sm-4 text-center">
                        <h3>Recommended Sector:
                        {{recommendedSector}}</h3>
                    </div>
                    <div class="col-sm-4 line-left text-center">
                        <h3>Courses Viewed : {{user.recentlyViewed.length}}</h3>
                    </div>
                </div>
            </div>

            <div class="card card-primary">
                <div class="card-header-pills">
                    <div class="card-block">
                        <h3 class="card-title ">
                                <span class="card-name" ng-click="results =! results">
                                    <i class="fa" ng-class="{'fa-plus':!results, 'fa-minus':results}"></i>
                                </span>
                            Results
                        </h3>
                        <div ng-if="results">
                            <tabset>
                                <tab heading="Spatial">
                                    <div class="tab-content">
                                        <table class="table table-striped">
                                            <thead class="thead-default">
                                            <tr>
                                                <th></th>
                                                <th>Test Name</th>
                                                <th>Score</th>
                                                <th>Date Completed</th>
                                                <th>View Courses</th>
                                                <th>Remove</th>
                                            </tr>
                                            </thead>
                                            <tbody class ="tbody" ng-repeat="result in user.results">
                                            <tr ng-show="result.testName == 'Spatial Reasoning'">
                                                <td></td>
                                                <td>{{result.testName}}</td>
                                                <td>{{result.score}}</td>
                                                <td>{{result.timeStamp | date : "hh:mm d MMM, yy" }}</td>
                                                <td class="search-icon-profile"><i class="material-icons" ng-click="goToCourses()">search</i></td>
                                                <td ng-click="removeResult(result._id)" class="remove-icon-profile"><i class="material-icons">remove_circle</i></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </tab>
                                <tab heading="Number Series">
                                    <div class="tab-content">
                                        <table class="table table-striped">
                                            <thead class="thead-default">
                                            <tr>
                                                <th></th>
                                                <th></th>
                                                <th>Test Name</th>
                                                <th>Score</th>
                                                <th>Date Completed</th>
                                                <th>View Courses</th>
                                                <th>Remove</th>
                                            </tr>
                                            </thead>
                                            <tbody class ="tbody" ng-repeat="result in user.results">
                                            <tr  ng-show="result.testName == 'Logical Number Series Test'">
                                                <td></td>
                                                <td></td>
                                                <td>{{result.testName}}</td>
                                                <td>{{result.score}}</td>
                                                <td>{{result.timeStamp | date : "hh:mm d MMM, yy" }}</td>
                                                <td class="search-icon-profile"><i class="material-icons" ng-click="goToCourses()">search</i></td>
                                                <td ng-click="removeResult(result._id)" class="remove-icon-profile"><i class="material-icons">remove_circle</i></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </tab>
                                <tab heading="Careers">
                                    <div class="tab-content">
                                        <table class="table table-striped">
                                            <thead class="thead-default">
                                            <tr>
                                                <th></th>
                                                <th></th>
                                                <th>Test Name</th>
                                                <th>Recommendation</th>
                                                <th>Date Completed</th>
                                                <th>Go To Sector</th>
                                                <th>Remove</th>
                                            </tr>
                                            </thead>
                                            <tbody class ="tbody" ng-repeat="result in user.results">
                                            <tr  ng-show="result.testName == 'Careers Test'">
                                                <td></td>
                                                <td></td>
                                                <td>{{result.testName}}</td>
                                                <td>{{result.recommend}}</td>
                                                <td>{{result.timeStamp | date : "hh:mm d MMM, yy" }}</td>
                                                <td class="search-icon-profile"><i class="material-icons" ng-click="goToSector(result.recommend)">search</i></td>
                                                <td ng-click="removeResult(result._id)" class="remove-icon-profile"><i class="material-icons">remove_circle</i></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </tab>
                            </tabset>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card card-primary">
                <div class="card-header-pills">
                    <div class="card-block">
                        <h3 class="card-title" >
                                <span class="card-name" ng-click="coursesTab = !coursesTab">
                                    <i class="fa" ng-class="{'fa-plus':!coursesTab, 'fa-minus':coursesTab}"></i>
                                </span>
                            Courses
                        </h3>
                        <div ng-if="coursesTab">
                            <tabset>
                                <div class="tab-content">
                                    <tab heading="Courses">
                                        <table class="table table-striped">
                                            <thead class="thead-deafult">
                                            <tr>
                                                <th>Course Name</th>
                                                <th>College</th>
                                                <th>Points</th>
                                                <th>Go To Course</th>
                                                <th>Remove</th>
                                            </tr>
                                            </thead>
                                            <tbody ng-repeat="course in user.courses">
                                            <tr>
                                                <td>{{course.title}}</td>
                                                <td>{{course.college}}</td>
                                                <td>{{course.points[0]}}</td>
                                                <td class="text-center search-icon-profile"><i class="material-icons" ng-click="goToCourse(course._id)">search</i></td>
                                                <td ng-click="removeCourse(course._id)" class="remove-icon-profile"><i class="material-icons">remove_circle</i></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </tab>
                                </div>
                            </tabset>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card card-primary">
                <div class="card-block">
                    <h3 class="card-title">
                        <span class="card-name" ng-click="showStats = !showStats">
                            <i class="fa" ng-class="{'fa-plus':!showStats, 'fa-minus':showStats}"></i>
                        </span>
                        Stats
                    </h3>
                    <div ng-if="showStats">
                        <tabset>
                            <tab heading="Recently Viewed">
                                <h1>Sectors of Recently Viewed Courses</h1>
                                <canvas id="radar" class="chart chart-radar" chart-data="data"
                                        chart-labels="labels"></canvas>
                            </tab>
                            <tab heading="{{user.firstName}}'s Test Results">
                                <h1 class="text-center">{{user.firstName}}'s Test Results</h1>
                                <canvas id="doughnut" class="chart chart-doughnut" chart-data="sdata"
                                        chart-labels="labels"></canvas>
                            </tab>
                            <tab heading="{{user.firstName}} test Results">
                                <h1 class="text-center">Compare Average Test Scores</h1>
                                <canvas chart-options="options" class="chart chart-bar" chart-data="averageData"
                                        chart-labels="averageLabels"></canvas>
                            </tab>
                            <tab heading="Spatial Progress">
                                <h1 class="text-center">{{user.firstName}}  Test Results</h1>
                                <canvas id="line1" class="chart chart-line" chart-data="spLineData"
                                        chart-options="options" chart-labels="spLineLabels"></canvas>
                            </tab>
                            <tab heading="Logical Progress">
                                <h1 class="text-center">{{user.firstName}}  Test Results</h1>
                                <canvas id="line2" class="chart chart-line" chart-data="numLineData"
                                        chart-options="options" chart-labels="numLineLabels"></canvas>
                            </tab>
                        </tabset>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
